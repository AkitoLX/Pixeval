<Page x:Class="Pixeval.Pages.Misc.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:actionableSettingEntry="using:Pixeval.Controls.Setting.UI.ActionableSettingEntry"
      xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:expander="using:Pixeval.Controls.Expander"
      xmlns:expanderSettingEntry="using:Pixeval.Controls.Setting.UI.ExpanderSettingEntry"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:model="using:Pixeval.Controls.Setting.UI.Model"
      xmlns:numberFormatting="using:Windows.Globalization.NumberFormatting"
      xmlns:options="using:Pixeval.Options"
      xmlns:settingsGroup="using:Pixeval.Controls.Setting.UI.SettingsGroup"
      xmlns:singleSelectionSettingEntry="using:Pixeval.Controls.Setting.UI.SingleSelectionSettingEntry"
      xmlns:sliderSettingEntry="using:Pixeval.Controls.Setting.UI.SliderSettingEntry"
      xmlns:switchSettingEntry="using:Pixeval.Controls.Setting.UI.SwitchSettingEntry"
      xmlns:system="using:System"
      xmlns:toolkit="using:CommunityToolkit.WinUI.UI"
      xmlns:ui="using:Pixeval.Util.UI"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
      mc:Ignorable="d">
    <!--  ReSharper disable UnusedMember.Local  -->
    <Page.Resources>
        <Style x:Key="SectionHeaderTextBlockStyle"
               TargetType="TextBlock">
            <Style.Setters>
                <Setter Property="Margin" Value="{StaticResource StackLayoutEntriesMargin}" />
                <Setter Property="FontSize" Value="{StaticResource PixevalContentFontSize}" />
            </Style.Setters>
        </Style>
        <Style x:Key="SectionInfoBarStyle"
               TargetType="InfoBar">
            <Style.Setters>
                <Setter Property="Margin" Value="{StaticResource StackLayoutEntryPadding}" />
                <Setter Property="HorizontalAlignment" Value="Left" />
                <Setter Property="IsOpen" Value="True" />
                <Setter Property="IsClosable" Value="False" />
                <Setter Property="Severity" Value="Informational" />
            </Style.Setters>
        </Style>
        <Style x:Key="SettingsNumberBoxStyle"
               TargetType="NumberBox">
            <Style.Setters>
                <Setter Property="HorizontalAlignment" Value="Left" />
                <Setter Property="Width" Value="100" />
                <Setter Property="IsWrapEnabled" Value="True" />
                <Setter Property="LargeChange" Value="10" />
                <Setter Property="NumberFormatter" Value="{StaticResource IntegerRoundedDecimalFormatter}" />
                <Setter Property="SmallChange" Value="1" />
                <Setter Property="SpinButtonPlacementMode" Value="Compact" />
                <Setter Property="ValidationMode" Value="Disabled" />
            </Style.Setters>
        </Style>
        <Style x:Key="NumberBoxWarningTeachingTipStyle"
               TargetType="TeachingTip">
            <Style.Setters>
                <Setter Property="IconSource" Value="{ui:FontIconSource Glyph=ErrorE783}" />
                <Setter Property="IsLightDismissEnabled" Value="True" />
                <Setter Property="PreferredPlacement" Value="TopRight" />
            </Style.Setters>
        </Style>
        <numberFormatting:DecimalFormatter x:Key="IntegerRoundedDecimalFormatter"
                                           FractionDigits="0">
            <numberFormatting:DecimalFormatter.NumberRounder>
                <numberFormatting:IncrementNumberRounder Increment="1"
                                                         RoundingAlgorithm="RoundHalfUp" />
            </numberFormatting:DecimalFormatter.NumberRounder>
        </numberFormatting:DecimalFormatter>
    </Page.Resources>
    <ScrollViewer x:Name="SettingsPageRootScrollViewer"
                  HorizontalScrollBarVisibility="Disabled"
                  HorizontalScrollMode="Disabled">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="10" />
                <RowDefinition />
                <RowDefinition Height="10" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="20" />
                <ColumnDefinition />
                <ColumnDefinition Width="20" />
            </Grid.ColumnDefinitions>
            <StackPanel x:Name="SettingEntriesPanel"
                        Grid.Row="1"
                        Grid.Column="1"
                        VerticalAlignment="Top">
                <settingsGroup:SettingsGroup x:Uid="/SettingsPage/ApplicationSettingsGroup">
                    <singleSelectionSettingEntry:SingleSelectionSettingEntry x:Uid="/SettingsPage/ThemeEntry"
                                                                             Icon="{ui:FontIcon Glyph=ColorE790}"
                                                                             ItemsSource="{x:Bind model:ApplicationThemeSettingEntryItem.AvailableItems}"
                                                                             SelectedItem="{x:Bind _viewModel.Theme, Mode=TwoWay}"
                                                                             SelectionChanged="SingleSelectionSettingEntry_OnSelectionChanged">
                        <singleSelectionSettingEntry:SingleSelectionSettingEntry.Description>
                            <HyperlinkButton x:Uid="/SettingsPage/ThemeEntryDescriptionHyperlinkButton" />
                        </singleSelectionSettingEntry:SingleSelectionSettingEntry.Description>
                    </singleSelectionSettingEntry:SingleSelectionSettingEntry>
                    <switchSettingEntry:SwitchSettingEntry x:Uid="/SettingsPage/DisableDomainFrontingEntry"
                                                           Icon="{ui:FontIcon Glyph=DisableUpdatesE8D8}"
                                                           IsOn="{x:Bind _viewModel.DisableDomainFronting, Mode=TwoWay}" />
                    <switchSettingEntry:SwitchSettingEntry x:Uid="/SettingsPage/UseFileCacheEntry"
                                                           Icon="{ui:FontIcon Glyph=FileExplorerEC50}"
                                                           IsOn="{x:Bind _viewModel.UseFileCache, Mode=TwoWay}" />
                    <switchSettingEntry:SwitchSettingEntry x:Uid="/SettingsPage/GenerateHelpLinkEntry"
                                                           Icon="{ui:FontIcon Glyph=LinkE71B}"
                                                           IsOn="{x:Bind _viewModel.DisplayTeachingTipWhenGeneratingAppLink, Mode=TwoWay}" />
                </settingsGroup:SettingsGroup>

                <settingsGroup:SettingsGroup x:Uid="/SettingsPage/BrowsingExperiencesGroup">
                    <singleSelectionSettingEntry:SingleSelectionSettingEntry x:Uid="/SettingsPage/ThumbnailDirectionEntry"
                                                                             Icon="{ui:FontIcon Glyph=LandscapeOrientationEF6B}"
                                                                             ItemsSource="{x:Bind model:ThumbnailDirectionSettingEntryItem.AvailableItems}"
                                                                             SelectedItem="{x:Bind _viewModel.ThumbnailDirection, Mode=TwoWay}" />
                    <expanderSettingEntry:ExpanderSettingEntry x:Uid="/SettingsPage/FiltrateRestrictedContentEntry"
                                                               Icon="{ui:FontIcon Glyph=BlockContactE8F8}">
                        <StackPanel>
                            <switchSettingEntry:SwitchSettingEntry x:Uid="/SettingsPage/FiltrateRestrictedContentEntrySwitch"
                                                                   Height="50"
                                                                   Background="Transparent"
                                                                   BorderThickness="0"
                                                                   CornerRadius="0"
                                                                   Icon="{ui:FontIcon Glyph=StatusCircleBlockF140}"
                                                                   IsOn="{x:Bind _viewModel.FiltrateRestrictedContent, Mode=TwoWay}" />
                            <actionableSettingEntry:ActionableSettingEntry x:Uid="/SettingsPage/ExcludeTagsEntry"
                                                                           Height="50"
                                                                           Background="Transparent"
                                                                           BorderThickness="0"
                                                                           CornerRadius="0"
                                                                           Icon="{ui:FontIcon Glyph=TagE8EC}">
                                <controls:TokenizingTextBox x:Uid="/SettingsPage/ExcludeTagsTokenTextBox"
                                                            MaxWidth="400"
                                                            MaxHeight="40"
                                                            CornerRadius="5"
                                                            ItemsSource="{x:Bind _viewModel.ExcludeTags}"
                                                            QueryIcon="{toolkit:SymbolIconSource Symbol=Tag}" />
                            </actionableSettingEntry:ActionableSettingEntry>
                        </StackPanel>
                    </expanderSettingEntry:ExpanderSettingEntry>
                    <singleSelectionSettingEntry:SingleSelectionSettingEntry x:Uid="/SettingsPage/TargetAPIPlatformEntry"
                                                                             Icon="{ui:FontIcon Glyph=CommandPromptE756}"
                                                                             ItemsSource="{x:Bind model:TargetPlatformSettingEntryItem.AvailableItems}"
                                                                             SelectedItem="{x:Bind _viewModel.TargetFilter, Mode=TwoWay}" />
                </settingsGroup:SettingsGroup>

                <settingsGroup:SettingsGroup x:Uid="/SettingsPage/SearchSettings">
                    <singleSelectionSettingEntry:SingleSelectionSettingEntry x:Uid="/SettingsPage/DefaultSearchSortOptionEntry"
                                                                             Icon="{ui:FontIcon Glyph=SortE8CB}"
                                                                             ItemsSource="{x:Bind model:IllustrationSortOptionSettingEntryItem.AvailableItems}"
                                                                             SelectedItem="{x:Bind _viewModel.DefaultSortOption, Mode=TwoWay}" />
                    <singleSelectionSettingEntry:SingleSelectionSettingEntry x:Uid="/SettingsPage/DefaultSearchTagMatchOptionEntry"
                                                                             Icon="{ui:FontIcon Glyph=PassiveAuthenticationF32A}"
                                                                             ItemsSource="{x:Bind model:SearchTagMatchOptionSettingEntryItem.AvailableItems}"
                                                                             SelectedItem="{x:Bind _viewModel.TagMatchOption, Mode=TwoWay}" />
                    <sliderSettingEntry:SliderSettingEntry x:Uid="/SettingsPage/MaximumSearchPageLimit"
                                                           Icon="{ui:FontIcon Glyph=RulerED5E}"
                                                           Maximum="100"
                                                           Minimum="1"
                                                           Value="{x:Bind _viewModel.PageLimitForKeywordSearch}" />
                    <sliderSettingEntry:SliderSettingEntry x:Uid="/SettingsPage/SearchStartsFromEntry"
                                                           Icon="{ui:FontIcon Glyph=StartPointE819}"
                                                           Maximum="150"
                                                           Minimum="1"
                                                           Value="{x:Bind _viewModel.SearchStartingFromPageNumber}" />
                </settingsGroup:SettingsGroup>

                <settingsGroup:SettingsGroup x:Uid="/SettingsPage/DownloadSettings">
                    <sliderSettingEntry:SliderSettingEntry x:Uid="/SettingsPage/MaxDownloadConcurrencyLevelEntry"
                                                           Icon="{ui:FontIcon Glyph=LightningBoltE945}"
                                                           Maximum="{x:Bind system:Environment.ProcessorCount}"
                                                           Minimum="1"
                                                           Value="{x:Bind _viewModel.MaxDownloadTaskConcurrencyLevel, Mode=TwoWay}" />
                </settingsGroup:SettingsGroup>

                <settingsGroup:SettingsGroup x:Uid="/SettingsPage/MiscGroup">
                    <sliderSettingEntry:SliderSettingEntry x:Uid="/SettingsPage/SpotlightSearchPageLimitEntry"
                                                           Icon="{ui:FontIcon Glyph=PictureE8B9}"
                                                           Maximum="100"
                                                           Minimum="1"
                                                           Value="{x:Bind _viewModel.PageLimitForSpotlight, Mode=TwoWay}" />
                    <sliderSettingEntry:SliderSettingEntry x:Uid="/SettingsPage/RecommendationItemLimit"
                                                           Icon="{ui:FontIcon Glyph=DialShape1F156}"
                                                           Maximum="1500"
                                                           Minimum="500"
                                                           Value="{x:Bind _viewModel.ItemsNumberLimitForDailyRecommendations, Mode=TwoWay}" />
                    <actionableSettingEntry:ActionableSettingEntry x:Uid="/SettingsPage/ImageMirrorServerEntry"
                                                                   Icon="{ui:FontIcon Glyph=HardDriveEDA2}">
                        <TextBox x:Uid="/SettingsPage/ImageMirrorServerTextBox"
                                 Width="200"
                                 Text="{x:Bind _viewModel.MirrorHost, Mode=TwoWay}" />
                    </actionableSettingEntry:ActionableSettingEntry>
                    <sliderSettingEntry:SliderSettingEntry x:Uid="/SettingsPage/PreloadRowsEntry"
                                                           Icon="{ui:FontIcon Glyph=ShowResultsE8BC}"
                                                           Maximum="15"
                                                           Minimum="0"
                                                           Value="{x:Bind _viewModel.PreLoadRows, Mode=TwoWay}" />
                </settingsGroup:SettingsGroup>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</Page>
